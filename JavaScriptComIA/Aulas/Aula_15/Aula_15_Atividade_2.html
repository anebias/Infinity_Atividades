<!-- Atividade 2
Você está consumindo uma API fictícia que retorna itens paginados com base no número da página (URL: https://api.example.com/items?page=X). Sua tarefa é implementar um código que permita navegar entre as páginas 1, 2 e 3, exibindo os resultados no console a cada troca de página.
- Para a navegação, use botões ou chamadas de função que simulem a troca de página. Além disso, implemente um pequeno delay artificial para simular o tempo de resposta da API.
- Requisitos:
    - Adicione controles para avançar e retroceder entre as páginas.
    - Exiba os dados retornados pela API no console.
    - Simule um pequeno delay antes de exibir os resultados para representar o tempo de resposta. -->

<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 15 - Atividade 2</title>
</head>

<body>

    <header>
        <h1>Paginação</h1>
    </header>

    <main>

        <div id="botoes">
            <button id="btnAnterior">anterior</button>
            <button id="btnProxima">próxima</button>
        </div>

        <div id="resultados">
            <ul></ul>
        </div>
    </main>

    <footer>
        <h4 id="footer"></h4>
    </footer>

    <script>
        const btnAnterior = document.getElementById('btnAnterior');
        const btnProxima = document.getElementById('btnProxima');
        const boxResultados = document.getElementById('resultados');
        const listaPagina = boxResultados.querySelector('ul');
        const footer = document.getElementById('footer');
        let paginaDestino = 1;
        let paginaAtual = 1;
        let quantidadePorPagina = 3;
        let message = '';

        btnAnterior.addEventListener('click', handleAnterior);
        btnProxima.addEventListener('click', handleProxima);

        function carregarPagina(quantidadePorPagina, paginaDestino) {
            listaPagina.innerHTML = " ";
            fetch(`https://jsonplaceholder.typicode.com/posts?_limit=${quantidadePorPagina}&_page=${paginaDestino}`)
                .then(response => {
                    if (response.status === 404) {
                        message = `${response.status} - Página não encontrada`
                        throw new Error(message);
                    };
                    return response
                })
                .then(response => (response.json()))
                .then(data => {
                    if (!data || data.length === 0) {
                        message = "Sem dados disponíveis na base"
                        throw new Error(message);
                    };

                    data.forEach(post => {
                        const divItem = document.createElement('div');
                        divItem.className = 'div-post';
                        divItem.id = post.id;

                        const liItem = document.createElement('li');
                        liItem.id = post.id;

                        const titleLiItem = document.createElement('h3');
                        const bodyLiItem = document.createElement('p');

                        liItem.textContent = `Post: ${post.id} | User: ${post.userId}`;

                        titleLiItem.textContent = post.title;
                        bodyLiItem.textContent = post.body;

                        liItem.appendChild(titleLiItem);
                        liItem.appendChild(bodyLiItem);
                        divItem.appendChild(liItem);
                        listaPagina.appendChild(divItem);

                        footer.textContent = `Página: ${paginaDestino} | Quantidade de itens na página: ${quantidadePorPagina}`;
                    });
                })
                .catch(error => console.error(error.message))
        };

        function handleAnterior() {
            if (paginaAtual > 1) {
                try {
                    paginaDestino = paginaAtual - 1;
                    carregarPagina(quantidadePorPagina, paginaDestino);
                    paginaAtual = paginaDestino;
                } catch { error => console.log(error.message) }
            } else { alert('Esta é a página inicial') }
        };

        async function handleProxima() {
            const totalPaginas = await totalRegistros(quantidadePorPagina);
            if (paginaAtual < totalPaginas) {
                try {
                    paginaDestino = paginaAtual + 1;
                    carregarPagina(quantidadePorPagina, paginaDestino);
                    paginaAtual = paginaDestino
                } catch { error => console.log(error.message) }

            } else { alert('Esta é a última página') }
        };

        async function totalRegistros(quantidadePorPagina) {
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts');

                if (response.status === 404) {
                    message = `${response.status} - Página não encontrada`
                    throw new Error("");
                };

                const data = await response.json();
                const totalRegistros = data.length;
                const totalPaginas = Math.ceil(totalRegistros / quantidadePorPagina);

                return totalPaginas

            } catch (error) { alert(error.message) }

        }

        carregarPagina(quantidadePorPagina, 1);

    </script>
</body>

</html>